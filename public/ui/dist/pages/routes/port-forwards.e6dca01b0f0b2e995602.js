webpackJsonp([17],{G0xc:function(t,e,r){(t.exports=r("FZ+f")(!1)).push([t.i,"",""])},H43E:function(t,e,r){var a=r("G0xc");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);r("rjj0")("9fed20a6",a,!1,{sourceMap:!1})},"QB/c":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r("QHB4"),n=r("pMge"),i=!1;var o=function(t){i||r("H43E")},s=r("VU/8")(a.a,n.a,!1,o,null,null);s.options.__file="pages/routes/port-forwards.vue",e.default=s.exports},QHB4:function(t,e,r){"use strict";var a=r("woOf"),n=r.n(a),i=r("Xxa5"),o=r.n(i),s=r("exGp"),l=r.n(s),d=r("Dd8w"),c=r.n(d),u=r("NYxO"),p=(r("4swq"),r("mtWM")),v=r.n(p);e.a={middleware:["authenticated"],components:{},computed:c()({},Object(u.mapGetters)({isAuthenticated:"auth/isAuthenticated",loggedUser:"auth/loggedUser",loggedToken:"auth/loggedToken"})),data:function(){return{error:{editing:"",global:""},snackbar:!1,snackbarColor:"green",snackbarText:"",snackbarTimeout:5e3,items:[],tableLoading:!0,tableNoData:"You have not added any port forwards.",tableHeaders:[{text:"Label",value:"label"},{text:"IP",value:"ip"},{text:"External Port",value:"port"},{text:"Internal Port",value:"srv_port"},{text:"Actions",value:"name",sortable:!1,align:"right"}],dialog:!1,editingIndex:-1,editingItem:{id:-1,label:"",ip:"",port:"",srv_type:"",srv_port:""},defaultItem:{id:-1,label:"",ip:"",port:"",srv_type:"",srv_port:""},editingPort:"",valid:!0,labelRule:[function(t){return!!t||"Label is required"},function(t){return t&&t.length<=100||"Label must be less than 100 characters"}],ipRule:[function(t){return!!t||"IP address is required"},function(t){return t&&/^(?!0)(?!\.)((^|\.)([1-9]?\d|1\d\d|2(5[0-5]|[0-4]\d))){4}$/gm.test(t)||"Invalid IP address"}],portRule:[function(t){return!!t||"External port is required"},function(t){return t&&!isNaN(t)||"Invalid port number"},function(t){return t&&0!==t||"Invalid port number"},function(t){return t&&t<65535||"Invalid port number"}],portCheck:[],srvPortRule:[function(t){return!!t||"Internal port is required"},function(t){return t&&!isNaN(t)||"Invalid port number"},function(t){return t&&0!==t||"Invalid port number"},function(t){return t&&t<65535||"Invalid port number"}]}},mounted:function(){v.a.defaults.headers.common.Authorization="Bearer "+this.loggedToken,this.initialize()},watch:{dialog:function(t){t||this.close()},"editingItem.port":function(t){var e=this;isNaN(t)||(this.valid=!1,this.checkAllowedPort(t).then(function(r){e.portCheck=r?[]:"Port not in allowed ranges: 2200-2299, 3300-3399, 4300-4399, 8000-8099",0===e.portCheck.length&&e.checkPortInUse(t).then(function(r){e.portCheck=r?-1!==e.editingIndex&&e.editingPort===t?[]:"Port in use":[],0===e.portCheck.length&&(e.valid=!0)})}))}},methods:{initialize:function(){var t=l()(o.a.mark(function t(){var e;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.loggedUser||this.$router.replace("/servers"),t.next=4,v.a.get(this.loggedUser.sub+"/api/routes/port-forwards");case 4:e=t.sent,this.items=e.data.data,t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),this.tableNoData="No data.",this.error.global="Could not fetch data from server.";case 12:this.tableLoading=!1;case 13:case"end":return t.stop()}},t,this,[[0,8]])}));return function(){return t.apply(this,arguments)}}(),checkPortInUse:function(){var t=l()(o.a.mark(function t(e){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.loggedUser||this.$router.replace("/servers"),t.next=4,v.a.post(this.loggedUser.sub+"/api/routes/port-forwards/check-port-in-use",{port:e});case 4:return r=t.sent,t.abrupt("return",Boolean(r.data.data));case 8:return t.prev=8,t.t0=t.catch(0),this.error.editing="Error checking port.",t.abrupt("return",!1);case 12:case"end":return t.stop()}},t,this,[[0,8]])}));return function(e){return t.apply(this,arguments)}}(),checkAllowedPort:function(){var t=l()(o.a.mark(function t(e){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.loggedUser||this.$router.replace("/servers"),t.next=4,v.a.post(this.loggedUser.sub+"/api/routes/port-forwards/check-allowed-port",{port:e});case 4:return r=t.sent,t.abrupt("return",Boolean(r.data.data));case 8:return t.prev=8,t.t0=t.catch(0),this.error.editing="Error checking port.",t.abrupt("return",!1);case 12:case"end":return t.stop()}},t,this,[[0,8]])}));return function(e){return t.apply(this,arguments)}}(),editItem:function(t){this.editingIndex=this.items.indexOf(t),this.editingItem=n()({},t),this.editingItem.port?this.editingPort=this.editingItem.port:this.editingPort="",this.dialog=!0},deleteItem:function(t){var e=this;this.$prompt.show({persistent:!0,width:400,toolbar:{color:"red darken-3",closable:!1},title:"Delete port forward?",text:"Are you sure you want to delete the <b>"+t.label+"</b> port forward?",buttons:[{title:"Yes",color:"success",handler:function(){var r=l()(o.a.mark(function r(){var a;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a=e.items.indexOf(t),e.items.splice(a,1),r.prev=2,e.loggedUser||e.$router.replace("/servers"),r.next=6,v.a.delete(e.loggedUser.sub+"/api/routes/port-forwards",{data:t});case 6:r.sent,e.snackbar=!0,e.snackbarText="Port forward successfully deleted.",r.next=14;break;case 11:r.prev=11,r.t0=r.catch(2),e.error.global="Could not delete port forward from server.";case 14:case"end":return r.stop()}},r,e,[[2,11]])}));return function(){return r.apply(this,arguments)}}()},{title:"No",color:"error"}]})},save:function(){var t=l()(o.a.mark(function t(){var e;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.$refs.form.validate()||!this.valid){t.next=12;break}return t.prev=1,this.loggedUser||this.$router.replace("/servers"),t.next=5,v.a.post(this.loggedUser.sub+"/api/routes/port-forwards",this.editingItem);case 5:(e=t.sent).data.error?e.data.error.port?this.error.editing=e.data.error.port:e.data.error.srv_port?this.error.editing=e.data.error.srv_port:e.data.error.query?this.error.editing=e.data.error.query:e.data.error.name?this.error.editing=e.data.error.name:this.error.editing="Something went wrong":(this.editingIndex>-1?n()(this.items[this.editingIndex],this.editingItem):this.items.push(n()({},this.editingItem)),this.snackbar=!0,this.snackbarText="Port forward successfully saved.",this.initialize(),this.close()),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),this.error.editing="Could not save port forward to server.";case 12:case"end":return t.stop()}},t,this,[[1,9]])}));return function(){return t.apply(this,arguments)}}(),close:function(){var t=this;this.dialog=!1,setTimeout(function(){t.editingItem=n()({},t.defaultItem),t.editingIndex=-1,t.editingPort=""},300)}}}},pMge:function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-app",[r("v-snackbar",{attrs:{top:"",timeout:t.snackbarTimeout,color:t.snackbarColor},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v("\n    "+t._s(t.snackbarText)+"\n    "),r("v-btn",{attrs:{dark:"",flat:""},nativeOn:{click:function(e){t.snackbar=!1}}},[t._v("Close")])],1),r("v-content",[r("v-container",{attrs:{fluid:"",tag:"section",id:"grid"}},[r("v-layout",{attrs:{row:"",wrap:""}},[r("v-flex",{attrs:{"d-flex":"",xs12:"","order-xs5":""}},[r("v-layout",{attrs:{column:""}},[r("v-flex",{staticClass:"display mb-2",attrs:{tag:"h1"}},[t._v("\n              Routes - Port Forwards\n              "),r("v-btn",{staticStyle:{float:"right"},attrs:{color:"success"},on:{click:function(e){t.dialog=!0}}},[t._v("New Forward")])],1),r("v-flex",[r("v-alert",{attrs:{type:"error",value:t.error.global}},[t._v("\n                "+t._s(t.error.global)+"\n              ")]),r("p",[t._v("Port forwards allow you to route TCP/UDP traffic into containers.")]),r("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.tableHeaders,items:t.items,"hide-actions":"",loading:t.tableLoading},scopedSlots:t._u([{key:"items",fn:function(e){return[r("td",[r("a",{attrs:{href:"javascript:void(0)"},on:{click:function(r){r.stopPropagation(),t.editItem(e.item)}}},[t._v(t._s(e.item.label))])]),r("td",[t._v(t._s(e.item.ip))]),r("td",[t._v(t._s(e.item.port))]),r("td",[t._v(t._s(e.item.srv_port))]),r("td",[r("v-btn",{staticClass:"mx-0",staticStyle:{float:"right"},attrs:{icon:""},on:{click:function(r){t.deleteItem(e.item)}}},[r("v-icon",{attrs:{color:"pink"}},[t._v("delete")])],1)],1)]}}])},[r("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"}),r("template",{slot:"no-data"},[t._v("\n                  "+t._s(t.tableLoading?"Fetching data, please wait...":t.tableNoData)+"\n                ")])],2)],1)],1)],1)],1)],1),r("v-dialog",{attrs:{"max-width":"600px",scrollable:""},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[r("v-card",{attrs:{tile:""}},[r("v-toolbar",{attrs:{card:"",dark:"",color:"light-blue darken-3"}},[r("v-btn",{attrs:{icon:"",dark:""},nativeOn:{click:function(e){t.dialog=!1}}},[r("v-icon",[t._v("close")])],1),r("v-toolbar-title",[t._v(t._s(-1===t.editingIndex?"New":"Edit")+" Port Forward")]),r("v-spacer"),r("v-toolbar-items",[r("v-btn",{attrs:{dark:"",flat:""},nativeOn:{click:function(e){t.save()}}},[t._v("Save")])],1)],1),r("v-card-text",{staticStyle:{padding:"0px"}},[r("v-card",{attrs:{flat:""}},[r("v-card-text",[r("v-alert",{attrs:{type:"error",value:t.error.editing}},[t._v("\n                "+t._s(t.error.editing)+"\n              ")]),r("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[r("v-text-field",{attrs:{rules:t.labelRule,label:"Label:",placeholder:"",required:"",hint:"Enter a label for the port forward."},model:{value:t.editingItem.label,callback:function(e){t.$set(t.editingItem,"label",e)},expression:"editingItem.label"}}),r("v-text-field",{attrs:{rules:t.ipRule,label:"IP:",placeholder:"",required:"",hint:"Enter the containers IP address for the port forward."},model:{value:t.editingItem.ip,callback:function(e){t.$set(t.editingItem,"ip",e)},expression:"editingItem.ip"}}),r("v-text-field",{attrs:{rules:t.portRule,"error-messages":t.portCheck,label:"External Port:",placeholder:"",required:"",hint:"Enter the external port to forward."},model:{value:t.editingItem.port,callback:function(e){t.$set(t.editingItem,"port",e)},expression:"editingItem.port"}}),r("v-text-field",{attrs:{rules:t.srvPortRule,label:"Internal Port:",placeholder:"",required:"",hint:"Enter the internal port to forward."},model:{value:t.editingItem.srv_port,callback:function(e){t.$set(t.editingItem,"srv_port",e)},expression:"editingItem.srv_port"}})],1)],1)],1)],1),r("div",{staticStyle:{flex:"1 1 auto"}})],1)],1)],1)],1)};a._withStripped=!0;var n={render:a,staticRenderFns:[]};e.a=n}});